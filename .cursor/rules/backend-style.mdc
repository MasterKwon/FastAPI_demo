---
description: 
globs: 
alwaysApply: true
---
# FastAPI ë°±ì—”ë“œ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ (í•œê¸€ í˜¼ìš©)

## ğŸ§  ê¸°ë³¸ ì›ì¹™ (Guiding Principles)

- ì‘ë‹µì€ ê°„ê²°í•˜ê³  ê¸°ìˆ ì ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
- í´ë˜ìŠ¤(class)ë³´ë‹¤ í•¨ìˆ˜ ê¸°ë°˜(functional, declarative) ìŠ¤íƒ€ì¼ì„ ì„ í˜¸í•©ë‹ˆë‹¤.
- ì¤‘ë³µì„ í”¼í•˜ê³  ë°˜ë³µ(iteration) ë° ëª¨ë“ˆí™”(modularization)ë¥¼ ìš°ì„ í•©ë‹ˆë‹¤.
- ë³€ìˆ˜ëª…ì€ ìƒíƒœë¥¼ ëª…í™•íˆ í‘œí˜„í•˜ëŠ” ì¡°ë™ì‚¬ë¥¼ í¬í•¨í•´ ì‘ì„±í•©ë‹ˆë‹¤ (ì˜ˆ: `is_active`, `has_permission`).
- ë””ë ‰í† ë¦¬ì™€ íŒŒì¼ ì´ë¦„ì€ ì†Œë¬¸ì + ì–¸ë”ìŠ¤ì½”ì–´(`_`) í˜•ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤ (ì˜ˆ: `routers/user_routes.py`).
- ë¼ìš°íŠ¸ì™€ ìœ í‹¸ í•¨ìˆ˜ëŠ” *named export* í˜•íƒœë¡œ ëª…ì‹œì ìœ¼ë¡œ exportí•©ë‹ˆë‹¤.
- ê°ì²´ë¥¼ ë°›ê³  ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” RORO(Receive an Object, Return an Object) íŒ¨í„´ì„ ë”°ë¦…ë‹ˆë‹¤.

---

## ğŸ Python / FastAPI ìŠ¤íƒ€ì¼

- ìˆœìˆ˜ í•¨ìˆ˜ëŠ” `def`, ë¹„ë™ê¸° ì‘ì—…ì—ëŠ” `async def`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ëª¨ë“  í•¨ìˆ˜ëŠ” `type hint`ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
- ì…ë ¥ ê²€ì¦ì€ ë”•ì…”ë„ˆë¦¬ ëŒ€ì‹  `Pydantic v2` ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- íŒŒì¼ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•©ë‹ˆë‹¤:
  - ë¼ìš°í„°(routers), ì„œë¸Œë¼ìš°í„°(subroutes), ìœ í‹¸ë¦¬í‹°(utilities), ì •ì  íŒŒì¼(static), íƒ€ì… ì •ì˜(types/models/schemas)
- ì¡°ê±´ë¬¸ì—ëŠ” ë¶ˆí•„ìš”í•œ ì¤‘ê´„í˜¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©°,
- ë‹¨ìˆœí•œ ì¡°ê±´ë¬¸ì€ í•œ ì¤„ë¡œ ì‘ì„±í•©ë‹ˆë‹¤ (ì˜ˆ: `if condition: do_something()`).

---

## ğŸš¨ ì˜ˆì™¸ ì²˜ë¦¬ ë° ê²€ì¦

- í•¨ìˆ˜ ì‹œì‘ ë¶€ë¶„ì—ì„œ ì˜¤ë¥˜ ë° ì—£ì§€ ì¼€ì´ìŠ¤ë¥¼ ë¨¼ì € ì²˜ë¦¬í•©ë‹ˆë‹¤ (early return).
- ì¤‘ì²©ëœ `if`ë¥¼ í”¼í•˜ê³  `guard clause`ë¥¼ ì ê·¹ í™œìš©í•©ë‹ˆë‹¤.
- "ì •ìƒ íë¦„(happy path)"ì€ í•­ìƒ ë§ˆì§€ë§‰ì— ë°°ì¹˜í•©ë‹ˆë‹¤.
- `if` ë¸”ë¡ í›„ì— `else`ëŠ” ë˜ë„ë¡ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì‚¬ìš©ì ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì œê³µí•˜ë©°,
- ì¼ê´€ëœ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•´ ì»¤ìŠ¤í…€ ì—ëŸ¬ íƒ€ì… ë˜ëŠ” ì—ëŸ¬ íŒ©í† ë¦¬(error factory)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

---

## ğŸ“¦ í”„ë¡œì íŠ¸ ì˜ì¡´ì„±

- âœ… ì‚¬ìš© ê¶Œì¥: `fastapi`, `pydantic>=2`, `asyncpg`, `aiomysql`, `psycopg2-binary`
- âŒ ì‚¬ìš© ê¸ˆì§€: `SQLAlchemy` (ì§ì ‘ SQL ì‚¬ìš© ì„ í˜¸)

---

## âš™ï¸ FastAPI ì‘ì„± ê·œì¹™

- ì…ë ¥ê³¼ ì¶œë ¥ì„ ìœ„í•´ `BaseModel`ì„ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜í˜• ë¼ìš°íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
- ëª¨ë“  ë¼ìš°íŠ¸ í•¨ìˆ˜ëŠ” `return type`ì„ ëª…ì‹œí•©ë‹ˆë‹¤.
- `@app.on_event("startup")` ëŒ€ì‹  `lifespan` ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ë¡œê¹…, ì—ëŸ¬ ëª¨ë‹ˆí„°ë§, ì„±ëŠ¥ ìµœì í™”ëŠ” *middleware*ì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ì˜ˆìƒ ê°€ëŠ¥í•œ ì—ëŸ¬ëŠ” `HTTPException`ì„ í†µí•´ ëª…í™•í•˜ê²Œ í‘œí˜„í•©ë‹ˆë‹¤.
- ì™¸ë¶€ API ë˜ëŠ” DB í˜¸ì¶œì€ ë°˜ë“œì‹œ `async`ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- `BaseModel`ì„ í†µí•œ ì§ë ¬í™”/ì—­ì§ë ¬í™”ë¥¼ ì¼ê´€ë˜ê²Œ ì ìš©í•©ë‹ˆë‹¤.

---

## ğŸš€ ì„±ëŠ¥ ìµœì í™” (Performance Tips)

- DBë‚˜ ì™¸ë¶€ API í˜¸ì¶œì€ ë°˜ë“œì‹œ ë¹„ë™ê¸°(async) ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- Redis ë˜ëŠ” ì¸ë©”ëª¨ë¦¬ ìºì‹±ì„ í†µí•´ ì •ì /ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°ë¥¼ ìºì‹±í•©ë‹ˆë‹¤.
- `Pydantic`ì„ íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ì§ë ¬í™” ì†ë„ë¥¼ ìµœì í™”í•©ë‹ˆë‹¤.
- ë°ì´í„°ì…‹ì´ í¬ê±°ë‚˜ ì‘ë‹µì´ í´ ê²½ìš° lazy loadingì„ ì ìš©í•©ë‹ˆë‹¤.

---

## ğŸ§± ì•„í‚¤í…ì²˜ ê°€ì´ë“œë¼ì¸

1. FastAPIì˜ *Dependency Injection* ì‹œìŠ¤í…œì„ í™œìš©í•´ ìƒíƒœë‚˜ ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
2. API ì„±ëŠ¥ ì§€í‘œ(ì‘ë‹µ ì†ë„, ì§€ì—°, ì²˜ë¦¬ëŸ‰)ë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.
3. ë¼ìš°íŠ¸ ë‚´ì—ì„œëŠ” ë¸”ë¡œí‚¹ ì—°ì‚°ì„ í”¼í•©ë‹ˆë‹¤:
   - ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìš°ì„ í•©ë‹ˆë‹¤.
   - DB, ì™¸ë¶€ API ì—°ì‚°ì€ ë³„ë„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.
   - ë¼ìš°íŠ¸ì™€ ì˜ì¡´ì„± êµ¬ì„±ì„ ëª…í™•íˆ í•˜ì—¬ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬

- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆëŠ” `database/schemas/*.sql` íŒŒì¼ì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.
- SQL íŒŒì¼ì€ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³  ì°¸ì¡°ë§Œ í•©ë‹ˆë‹¤.
- ìƒˆë¡œìš´ ëª¨ë¸ ìƒì„±/ìˆ˜ì • ì‹œ:
  1. SQL íŒŒì¼ì˜ í…Œì´ë¸” êµ¬ì¡°ë¥¼ ë¨¼ì € í™•ì¸
  2. í•´ë‹¹ êµ¬ì¡°ì— ë§ì¶° Pydantic ëª¨ë¸ ìƒì„±/ìˆ˜ì •
  3. í•„ìš”í•œ ê²½ìš° ëª¨ë¸ì— ëŒ€í•œ ì¶”ê°€ ì„¤ëª… ìš”ì²­
- í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš° ë¨¼ì € ë…¼ì˜ í›„ ì§„í–‰
- ëª¨ë¸ê³¼ ì‹¤ì œ DB ìŠ¤í‚¤ë§ˆì˜ ì¼ê´€ì„± ìœ ì§€

---

## ğŸ“Š ì—‘ì…€ ë°ì´í„° ì²˜ë¦¬

- ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì‹œ ì»¬ëŸ¼ëª… ëŒ€ì‹  ì»¬ëŸ¼ ìˆœì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ì»¬ëŸ¼ ìˆœì„œëŠ” 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì—‘ì…€ íŒŒì¼ì˜ êµ¬ì¡°ê°€ ë³€ê²½ë  ê²½ìš° ìˆœì„œë§Œ ìœ ì§€ë˜ë©´ ì½”ë“œ ìˆ˜ì •ì´ í•„ìš” ì—†ë„ë¡ ì„¤ê³„í•©ë‹ˆë‹¤.
- ë°ì´í„° ë§¤í•‘ì€ ëª…ì‹œì ì¸ ì¸ë±ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

ì˜ˆì‹œ:
```python
# ê¶Œì¥í•˜ëŠ” ë°©ì‹
def process_excel_row(row: List[str]) -> Dict:
    return {
        "name": row[0],      # ì²« ë²ˆì§¸ ì»¬ëŸ¼
        "age": int(row[1]),  # ë‘ ë²ˆì§¸ ì»¬ëŸ¼
        "email": row[2]      # ì„¸ ë²ˆì§¸ ì»¬ëŸ¼
    }

# í”¼í•´ì•¼ í•  ë°©ì‹
def process_excel_row(row: Dict) -> Dict:
    return {
        "name": row["ì´ë¦„"],     # ì»¬ëŸ¼ëª… ì§ì ‘ ì°¸ì¡°
        "age": int(row["ë‚˜ì´"]), # ì»¬ëŸ¼ëª… ì§ì ‘ ì°¸ì¡°
        "email": row["ì´ë©”ì¼"]   # ì»¬ëŸ¼ëª… ì§ì ‘ ì°¸ì¡°
    }
```

---

ğŸ“š ì°¸ê³ : [FastAPI ê³µì‹ ë¬¸ì„œ](mdc:https:/fastapi.tiangolo.com)





